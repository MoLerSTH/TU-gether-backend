<!--  app/templates/admin/admin_user.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>User Management</title>
  <link rel="stylesheet" href="admin_user.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
</head>
<body>

  <!-- FIX: Added content wrapper -->
  <div class="content-wrapper">
    <header class="admin-header">
      <h1 class="admin-title"><i class='bx bx-user' ></i> User Management</h1>
      <nav>
        <a class="btn" href="/admin"><i class='bx bx-cog' ></i> Dashboard</a>
        <a class="btn" href="/main"><i class='bx bx-home'></i> Home</a>
        <!--<a class="btn outline" id="logout-link"><i class='bx bx-log-out'></i> Logout</a>-->
      </nav>
    </header>
    
    <!-- FIX: Removed control-group div -->

    <div class="table-container">
      
      <!-- FIX: Added header for tabs and search -->
      <div class="table-header-controls">
        <!-- MOVED: View toggle buttons are now tabs -->
        <div class="view-toggle">
          <button id="generalViewBtn" class="toggle-btn active">
            <i class="fas fa-user"></i> General Users
          </button>
          <button id="studentViewBtn" class="toggle-btn">
            <i class="fas fa-user-graduate"></i> Student
          </button>
        </div>
        
        <!-- MOVED: Search/Add buttons are here -->
        <div class="table-tpRight-container">
          <input type="text" id="searchInput" placeholder="Search by name, role, or ID...">
          <button id="addUserBtn" class="primary-btn">
            <i class="fa-solid fa-user-plus"></i> Add User
          </button>
        </div>
      </div>

      <table id="userTable">
        <thead id="tableHead"></thead>
        <tbody></tbody>
      </table>
    </div>
  </div> <!-- End of content-wrapper -->

  <div id="pagination"></div>

  <!-- Modal (Redesigned Structure) -->
  <div id="userModal" class="modal">
    <div class="modal-content">
      <!-- Modal Header -->
      <div class="modal-header">
        <h2 id="modalTitle">Add User</h2>
        <button class="close-btn" id="closeModalBtn">&times;</button>
      </div>
      
      <!-- Modal Body -->
      <div class="modal-body">
        <form id="userForm">
          <input type="hidden" id="userId">
          
          <!-- Form Group: User Type (Full Width) -->
          <div class="form-group form-group-full">
            <label for="userType">User Type</label>
            <select id="userType">
              <option value="General">General User</option>
              <option value="Student">Student</option>
            </select>
          </div>

          <!-- Form Group: Username (General User) -->
          <div class="form-group general-field">
            <label for="username">Username</label>
            <input type="text" id="username" required>
          </div>

          <!-- Form Group: Student ID (Student) -->
          <div class="form-group student-field hidden">
            <label for="studentId">Student ID (10 digits)</label>
            <input type="text" id="studentId" required maxlength="10">
          </div>

          <!-- Form Group: Password -->
          <div class="form-group">
            <label for="password">Password</label>
            <input type="password" id="password"> <!-- 'required' is set by JS -->
            <small>Leave blank to keep current password when editing.</small>
          </div>

          <!-- FIX: Form Group: Name -->
          <div class="form-group">
            <label for="name">Name</label>
            <input type="text" id="name" required>
          </div>

          <!-- FIX: Form Group: Lastname -->
          <div class="form-group">
            <label for="lastname">Lastname</label>
            <input type="text" id="lastname" required>
          </div>

          <!-- Form Group: Email (Full Width) -->
          <div class="form-group form-group-full">
            <label for="email">Email</label>
            <input type="email" id="email" required>
          </div>

          <!-- Form Group: Phone (General User) -->
          <div class="form-group general-field">
            <label for="phone">Phone</label>
            <input type="text" id="phone" required>
          </div>

          <!-- FIX: Form Group: Identification ID (Student) -->
          <div class="form-group student-field hidden">
            <label for="identificationId">Identification ID (13 digits)</label>
            <input type="text" id="identificationId" required maxlength="13">
          </div>

          <!-- Form Group: Role -->
          <div class="form-group">
            <label for="role">Role</label>
            <select id="role">
              <option value="User">User</option>
              <option value="Admin">Admin</option>
            </select>
          </div>
          
          <!-- Student-specific fields (Full Width Container) -->
          <div id="studentFields" class="student-field hidden form-group-full">
            <div class="student-fields-grid">
              <div class="form-group">
                <label for="faculty">Faculty</label>
                <!-- FIX: Changed from input to select -->
                <select id="faculty"></select>
              </div>
              <div class="form-group">
                <label for="major">Major</label>
                <!-- FIX: Changed from input to select -->
                <select id="major"></select>
              </div>
              <div class="form-group">
                <label for="year">Year</label>
                <input type="number" id="year" min="1" max="8">
              </div>
            </div>
          </div>

        </form>
      </div>
      
      <!-- Modal Footer -->
      <div class="modal-footer">
        <button id="cancelModalBtn" class="secondary-btn">Cancel</button>
        <button type="submit" id="saveUserBtn" class="primary-btn" form="userForm">Save</button>
      </div>
    </div>
  </div>

  <!-- Confirmation Modal -->
  <div id="confirmModal" class="modal">
    <div class="modal-content" style="max-width: 400px;">
      <div class="modal-header">
        <h2 id="confirmTitle">Confirm Action</h2>
        <button class="close-btn" id="closeConfirmModalBtn">&times;</button>
      </div>
      <div class="modal-body">
        <p id="confirmMessage">Are you sure you want to delete this user?</p>
      </div>
      <div class="modal-footer">
        <button id="cancelConfirmBtn" class="secondary-btn">Cancel</button>
        <button id="confirmBtn" class="danger-btn">Delete</button>
      </div>
    </div>
  </div>


  <div id="notification"></div>

  <link rel="stylesheet" href="/static/css/admin_user.css">
  <script src="/static/js/admin_user.js"></script>
</body>
</html>